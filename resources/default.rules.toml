# ==============================================================================
#  Official DREIDING Atom Typing Ruleset for dreid-typer
#  Version: 2.1.0
#  Authors: Tony Kan, William A. Goddard III
# ==============================================================================

# ------------------------------------------------------------------------------
# §1. Special Topology Rules (Highest Priority)
#    These identify unique bonding patterns that override all other chemistry.
# ------------------------------------------------------------------------------

[[rule]]
name = "H_Bridge_Diborane"
priority = 500
type = "H_b"
conditions = { element = "H", degree = 2, neighbor_elements = { B = 2 } }

# ------------------------------------------------------------------------------
# §2. Generalized Resonance Rules (High Priority)
#    `Hybridization::Resonant` is the most powerful classifier, capturing all
#    atoms in delocalized pi-systems (aromatic, carboxylates, amides, etc.).
# ------------------------------------------------------------------------------

[[rule]]
name = "C_Resonant_Terminal"
priority = 401
type = "C_2"
conditions = { element = "C", hybridization = "Resonant", degree = 1 }

[[rule]]
name = "N_Resonant_Terminal"
priority = 401
type = "N_2"
conditions = { element = "N", hybridization = "Resonant", degree = 1 }

[[rule]]
name = "O_Resonant_Terminal"
priority = 401
type = "O_2"
conditions = { element = "O", hybridization = "Resonant", degree = 1 }

[[rule]]
name = "S_Resonant_Terminal"
priority = 401
type = "S_2"
conditions = { element = "S", hybridization = "Resonant", degree = 1 }

[[rule]]
name = "C_Resonant"
priority = 400
type = "C_R"
conditions = { element = "C", hybridization = "Resonant" }

[[rule]]
name = "N_Resonant"
priority = 400
type = "N_R"
conditions = { element = "N", hybridization = "Resonant" }

[[rule]]
name = "O_Resonant"
priority = 400
type = "O_R"
conditions = { element = "O", hybridization = "Resonant" }

[[rule]]
name = "S_Resonant"
priority = 400
type = "S_R"
conditions = { element = "S", hybridization = "Resonant" }

# ------------------------------------------------------------------------------
# §3. Geometry-Based Rules (Standard Hierarchy: SP > SP2 > SP3)
#    These rules map directly from the perceived hybridization state.
# ------------------------------------------------------------------------------

[[rule]]
name = "C_Linear_SP"
priority = 300
type = "C_1"
conditions = { element = "C", hybridization = "SP" }

[[rule]]
name = "N_Linear_SP"
priority = 300
type = "N_1"
conditions = { element = "N", hybridization = "SP" }

[[rule]]
name = "C_Trigonal_SP2"
priority = 200
type = "C_2"
conditions = { element = "C", hybridization = "SP2" }

[[rule]]
name = "N_Trigonal_SP2"
priority = 200
type = "N_2"
conditions = { element = "N", hybridization = "SP2" }

[[rule]]
name = "O_Trigonal_SP2"
priority = 200
type = "O_2"
conditions = { element = "O", hybridization = "SP2" }

[[rule]]
name = "S_Trigonal_SP2"
priority = 200
type = "S_2"
conditions = { element = "S", hybridization = "SP2" }

[[rule]]
name = "B_Trigonal_SP2"
priority = 200
type = "B_2"
conditions = { element = "B", hybridization = "SP2" }

[[rule]]
name = "C_Tetrahedral_SP3"
priority = 100
type = "C_3"
conditions = { element = "C", hybridization = "SP3" }

[[rule]]
name = "N_Tetrahedral_SP3"
priority = 100
type = "N_3"
conditions = { element = "N", hybridization = "SP3" }

[[rule]]
name = "O_Tetrahedral_SP3"
priority = 100
type = "O_3"
conditions = { element = "O", hybridization = "SP3" }

[[rule]]
name = "P_Tetrahedral_SP3"
priority = 100
type = "P_3"
conditions = { element = "P", hybridization = "SP3" }

[[rule]]
name = "S_Tetrahedral_SP3"
priority = 100
type = "S_3"
conditions = { element = "S", hybridization = "SP3" }

[[rule]]
name = "B_Tetrahedral_SP3"
priority = 100
type = "B_3"
conditions = { element = "B", hybridization = "SP3" }

[[rule]]
name = "Si_Tetrahedral_SP3"
priority = 101
type = "Si3"
conditions = { element = "Si", hybridization = "SP3" }

[[rule]]
name = "Al_Tetrahedral_SP3"
priority = 101
type = "Al3"
conditions = { element = "Al", hybridization = "SP3" }

[[rule]]
name = "Ge_Tetrahedral_SP3"
priority = 101
type = "Ge3"
conditions = { element = "Ge", hybridization = "SP3" }

[[rule]]
name = "As_Tetrahedral_SP3"
priority = 101
type = "As3"
conditions = { element = "As", hybridization = "SP3" }

[[rule]]
name = "Se_Tetrahedral_SP3"
priority = 101
type = "Se3"
conditions = { element = "Se", hybridization = "SP3" }

[[rule]]
name = "Sn_Tetrahedral_SP3"
priority = 101
type = "Sn3"
conditions = { element = "Sn", hybridization = "SP3" }

[[rule]]
name = "Sb_Tetrahedral_SP3"
priority = 101
type = "Sb3"
conditions = { element = "Sb", hybridization = "SP3" }

[[rule]]
name = "Te_Tetrahedral_SP3"
priority = 101
type = "Te3"
conditions = { element = "Te", hybridization = "SP3" }

# ------------------------------------------------------------------------------
# §4. Hydrogen Types
#    These rules depend on the hydrogen's neighbor.
# ------------------------------------------------------------------------------

[[rule]]
name = "H_Donor_On_Oxygen"
priority = 80
type = "H_HB"
conditions = { element = "H", neighbor_elements = { O = 1 } }

[[rule]]
name = "H_Donor_On_Nitrogen"
priority = 79
type = "H_HB"
conditions = { element = "H", neighbor_elements = { N = 1 } }

[[rule]]
name = "H_Donor_On_Sulfur"
priority = 78
type = "H_HB"
conditions = { element = "H", neighbor_elements = { S = 1 } }

[[rule]]
name = "H_Standard_Default"
priority = 1
type = "H_"
conditions = { element = "H" }

# ------------------------------------------------------------------------------
# §5. Halogens (Medium-Low Priority)
#    These are typically terminal atoms with `Hybridization::None`.
# ------------------------------------------------------------------------------

[[rule]]
name = "Halogen_F"
priority = 50
type = "F_"
conditions = { element = "F" }

[[rule]]
name = "Halogen_Cl"
priority = 50
type = "Cl"
conditions = { element = "Cl" }

[[rule]]
name = "Halogen_Br"
priority = 50
type = "Br"
conditions = { element = "Br" }

[[rule]]
name = "Halogen_I"
priority = 50
type = "I_"
conditions = { element = "I" }

# ------------------------------------------------------------------------------
# §6. Metals and Ions (Low Priority)
#    These are often isolated or have `Hybridization::None`.
# ------------------------------------------------------------------------------

[[rule]]
name = "Metal_Na"
priority = 20
type = "Na"
conditions = { element = "Na" }

[[rule]]
name = "Metal_Ca"
priority = 20
type = "Ca"
conditions = { element = "Ca" }

[[rule]]
name = "Metal_Fe"
priority = 20
type = "Fe"
conditions = { element = "Fe" }

[[rule]]
name = "Metal_Zn"
priority = 20
type = "Zn"
conditions = { element = "Zn" }

[[rule]]
name = "Metal_Mg"
priority = 20
type = "Mg"
conditions = { element = "Mg" }

[[rule]]
name = "Metal_Mn"
priority = 20
type = "Mn"
conditions = { element = "Mn" }

[[rule]]
name = "Metal_Ti"
priority = 20
type = "Ti"
conditions = { element = "Ti" }

[[rule]]
name = "Metal_Tc"
priority = 20
type = "Tc"
conditions = { element = "Tc" }

[[rule]]
name = "Metal_Ru"
priority = 20
type = "Ru"
conditions = { element = "Ru" }

[[rule]]
name = "Metal_Hg"
priority = 20
type = "Hg"
conditions = { element = "Hg" }
